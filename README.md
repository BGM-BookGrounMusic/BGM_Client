# 🎵 Book Ground Music
전자책 텍스트 분석을 통해 실시간으로 분위기에 맞는 배경음악을 제공해주는 백그라운드 어플리케이션입니다.

![image](https://github.com/BGM-BookGroundMusic/BGM_Client/assets/96529879/8ff22ddc-ff4f-4f4e-8c42-30484c57f75d)

## Step 1. 전자책 텍스트 데이터 수집

'MediaProjectionAPI'를 사용하여 실시간 스크린샷을 백그라운드로 자동 진행한다. 이후 실시간 스크린샷을 통해 얻은 Bitmap 형태의 전자책 화면을 OCR 처리하여 텍스트 데이터를 수집했다 (Firebase ML Kit에서 제공하는 Text Recognizer를 사용). 연속으로 스크린샷을 찍는 함수 screenshotSeries를 구현하고, 이 함수 내부에서 Text Recognizer 객체를 만들고 불러와 OCR 처리함  Handler를 이용하여 일정 시간 간격으로, 5회 반복하도록 설정했다.
수집된 텍스트 데이터를 바탕으로 감성분석을 진행한다. 

## Step 2. 텍스트 감성분석

약 8만건의 한국어 말뭉치를 바탕으로 감성분석 모델을 만들어서 어플에서 사용할 수 있게끔 구현했다. 문장별로 채택된 감성을 종합하여 전체 감정 비율을 파악 이후, 설정된 임계값을 특정 감성 비율이 넘었을 때, 현재 화면의 최종 감정값을 긍정(1), 중립(0), 부정(-1)으로 판별한다. 이후, 시간별로 연속적으로 페이지를 분석하여 현재 재생되는 음악이 끝나기 80초 전, 총 5회의 감성분석을 시행한다. 과거보다 최근에 분석된 감성에 더 높은 가중치W를 두어 전체적인 분위기에 대한 가중평균을 계산(-1~1)하여 현재 사용자가 읽고있는 텍스트의 감성을 확정한다.


## Step 3. 감성 음악 매칭
앞선 단계에서 얻은 최종감성에 매칭하는 음악을 사용자에게 들려준다. 음악은 감성음악과 중립음악으로 구성되며 음악 감성 분류기(CNN)는 부정, 중립, 긍정의 3가지로 분류한다. 이 중 중립으로 분류된 음악은 사용자의 취향을 반영한 음악으로, 부정/긍정으로 분류된 음악은 감성음악으로 설정했다. [텍스트 감성분석]에서 최종적으로 계산한 가중평군값이 미리 설정한 민감도 기준을 넘겼을 때 최종 감성을 판별하고 알고리즘에 따라 감성음악 혹은 중립음악으로 변경된다. 
